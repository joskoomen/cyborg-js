{"version":3,"file":"cyborg-js.umd.js","sources":["../src/constants/EventNames.ts","../src/notifications/Notification.ts","../src/notifications/NotificationBody.ts","../src/notifications/NotificationController.ts","../src/core/MotherBoard.ts","../src/functions/walkDom.ts","../src/functions/cyborgEval.ts","../src/core/Component.ts","../src/cyborg-js.ts"],"sourcesContent":["export enum EventNames {\n  DOCUMENT_READY= 'DOMContentLoaded',\n  NODE_REMOVED= 'DOMNodeRemovedFromDocument'\n};\n","import { ICanHandleNotifications } from \"../interfaces/ICanHandleNotifications\";\n\nexport class Notification {\n    readonly name: string;\n    readonly target: ICanHandleNotifications;\n    readonly handler: Function;\n\n    constructor(pTarget: ICanHandleNotifications, pName: string, pHandler: Function) {\n        this.name = pName;\n        this.handler = pHandler;\n        this.target = pTarget;\n    }\n}","export class NotificationBody {\n    notification: string;\n    payload: Record<string, any>;\n\n    constructor(pType: string, pPayload?: Record<string, any>) {\n        this.notification = pType;\n        this.payload = pPayload || {};\n    }\n}","import { Notification } from \"./Notification\";\nimport { NotificationBody } from \"./NotificationBody\";\nimport { IAmComponent } from \"../interfaces/IAmComponent\";\nimport { ICanHandleNotifications } from \"../interfaces/ICanHandleNotifications\";\n\nexport class NotificationController {\n    static _instance: NotificationController;\n\n    private _listeners: Array<Notification>;\n\n    constructor() {\n        if (NotificationController._instance) {\n            throw new Error('Use NotificationController.getInstance()');\n        }\n        NotificationController._instance = this;\n        this._listeners = [];\n    }\n\n    static getInstance(): NotificationController {\n        if (NotificationController._instance) {\n            return NotificationController._instance;\n        }\n        return new NotificationController();\n    }\n\n    /**\n     * emit a notification\n     * @param pType\n     * @param pParams\n     */\n    notify(pType: string, pParams?: Record<string, any>): void {\n        const listeners: ReadonlyArray<Notification> = this._listeners;\n        const notes: ReadonlyArray<Notification> = listeners.filter((listener: Notification) => {\n            return listener.name === pType;\n        });\n\n        notes.forEach((note: Notification) => {\n            const body: NotificationBody = new NotificationBody(pType, pParams || {});\n            note.handler(body);\n        });\n    }\n\n    /**\n     * Add a Notification Listener\n     * @param pTarget\n     * @param pType\n     * @param pHandler\n     */\n    addNotificationListener(pTarget: ICanHandleNotifications, pType: string, pHandler: Function): void {\n        const note: Notification = new Notification(pTarget, pType, pHandler.bind(pTarget));\n        this._listeners.push(note);\n    }\n\n    /**\n     * Remove a given listener. This only removes one record.\n     * @param pType string Notification name\n     * @param pTarget Component object\n     */\n    removeNotificationListener(pType: string, pTarget: any): void {\n        const listeners: Array<Notification> = this._listeners;\n        const index: number = listeners.findIndex((notification: Notification): boolean => {\n            return (notification.name === pType) && (notification.target === pTarget);\n        });\n        this._listeners = listeners.splice(index, 1);\n    }\n\n    removeAllListenersFor(pInstance: IAmComponent): void {\n        const listeners: Array<Notification> = this._listeners;\n        this._listeners = listeners.filter((notification: Notification): boolean => {\n            return (notification.target.name !== pInstance.name);\n        });\n    }\n\n    get listeners(): Array<Notification> {\n        return this._listeners;\n    }\n}","import { NotificationRegistration } from '../notifications/NotificationRegistration';\nimport { EventNames } from '../constants/EventNames';\nimport { NotificationController } from '../notifications/NotificationController';\nimport { IAmComponent } from '../interfaces/IAmComponent';\nimport type { ComponentMap } from './ComponentMap';\nimport { ICanHandleNotifications } from '../interfaces/ICanHandleNotifications';\n\ndeclare interface ComponentConstructor {\n  new (): IAmComponent;\n}\n\ndeclare const componentsMapping: Map<string, ComponentConstructor>;\n\nexport class MotherBoard {\n  static _instance: MotherBoard;\n\n  public componentsMap: Array<ComponentMap> = [];\n  private _components: Array<IAmComponent> = [];\n  private _data: Record<string, any> = {};\n\n  constructor() {\n    if (MotherBoard._instance) {\n      throw new Error('Use MotherBoard.getInstance()');\n    }\n    MotherBoard._instance = this;\n    this.init();\n  }\n\n  static getInstance(): MotherBoard {\n    if (MotherBoard._instance) {\n      return MotherBoard._instance;\n    }\n    return new MotherBoard();\n  }\n\n  /**\n   * Init Application.\n   */\n  init(): void {\n    window.onload = (): void => {\n      this.onload();\n    };\n\n    window.onunload = (): void => {\n      this.onunload();\n    };\n\n    window.onpagehide = (): void => {\n      this.destroy();\n    };\n\n    document.addEventListener(\n      EventNames.DOCUMENT_READY,\n      (): void => {\n        this.bind();\n      },\n      false\n    );\n  }\n\n  /**\n   * Document ready handler\n   */\n  bind(): void {\n    const html: HTMLHtmlElement | null = document.querySelector('html');\n    if (!html) {\n      throw Error('No html tag available');\n    }\n\n    html.classList.remove('no-js');\n    html.classList.add('js');\n    this.build(html);\n  }\n\n  build(pEl: HTMLElement): void {\n    const componentsList: Array<HTMLElement> = Array.from(\n      pEl.querySelectorAll('[data-component]')\n    );\n    if (componentsList.length > 0) {\n      componentsList.forEach((el: HTMLElement) => {\n        const dataset: DOMStringMap = el.dataset;\n        if (dataset && dataset.component) {\n          const componentsArray: Array<string> = dataset.component\n            .replace(' ', '')\n            .split(',');\n          componentsArray.forEach((componentString: string) => {\n            const ComponentClass: ComponentMap | null = MotherBoard.getComponentMapByName(\n              this.componentsMap,\n              componentString\n            );\n            if (ComponentClass) {\n              const component: IAmComponent = new ComponentClass.class();\n              console.log('component', component);\n              if (\n                component.notifications &&\n                component.notifications.length > 0\n              ) {\n                this.registerNotification({\n                  name: componentString,\n                  notifications: component.notifications,\n                  classRef: component,\n                });\n              }\n\n              component.bind(el);\n              this._components.push(component);\n              this.destroyComponentListener(component, el);\n            }\n          });\n        }\n      });\n    }\n  }\n\n  /**\n   * Window onload handler\n   */\n  onload(): void {\n    this._components.forEach((pComponent: IAmComponent) => {\n      pComponent.onload();\n    });\n  }\n\n  onunload(): void {\n    this._components.forEach((pComponent: IAmComponent) => {\n      pComponent.onunload();\n    });\n  }\n\n  destroyComponentListener(pComponent: IAmComponent, pEl: HTMLElement): void {\n    let component: IAmComponent | null = pComponent;\n    let el: HTMLElement | null = pEl;\n    if (el) {\n      if (window.MutationObserver) {\n        let observer: MutationObserver | null = new MutationObserver(\n          (mutations: Array<MutationRecord>) => {\n            mutations.forEach((mutation: MutationRecord) => {\n              mutation.removedNodes.forEach((removedNode: Node) => {\n                if (component && removedNode === pEl) {\n                  component.destroy();\n                  if (observer) {\n                    observer.disconnect();\n                    observer = null;\n                  }\n                  component = null;\n                  el = null;\n                }\n              });\n            });\n          }\n        );\n        observer.observe(document, {\n          childList: true,\n          subtree: true,\n        });\n      } else {\n        pComponent.addEventListener(EventNames.NODE_REMOVED, function() {\n          pComponent.destroy();\n          component = null;\n          el = null;\n        });\n      }\n    }\n  }\n\n  registerNotification(pObject: NotificationRegistration): void {\n    if (pObject.notifications) {\n      const notifications: ReadonlyArray<string> = pObject.notifications;\n      const classRef: ICanHandleNotifications = pObject.classRef;\n      notifications.forEach((pNotification: string) => {\n        \n        this.notifier.addNotificationListener(\n          classRef,\n          pNotification,\n          // eslint-disable-next-line @typescript-eslint/unbound-method\n          classRef.handleNotifications\n        );\n      });\n    }\n  }\n\n  /**\n   * Get NotificationController access.\n   * @returns {NotificationController}\n   */\n  get notifier(): NotificationController {\n    return NotificationController.getInstance();\n  }\n\n  get data(): Record<string, any> {\n    return this._data;\n  }\n\n  get components(): ReadonlyArray<IAmComponent> {\n    return this._components;\n  }\n\n  /**\n   */\n  static getComponentMapByName(\n    pArray: Array<ComponentMap>,\n    pName: string\n  ): ComponentMap | null {\n    if (pArray && (pArray.length > 0)) {\n      let component: ComponentMap | null = pArray.find((pRec:ComponentMap) => pRec.reference === pName) || null;\n      return component;\n    }\n    return null;\n  }\n\n  /**\n   * destroy application\n   */\n  destroy(): void {\n    while (this._components.length > 0) {\n      const component: IAmComponent = this._components[0];\n      if (component && component.el) {\n        component.el.remove();\n      }\n      this._components.shift();\n    }\n  }\n}","export function walkDom(pEl: Element | null, pCallback: Function): void{\n    if (pEl) {\n        pCallback(pEl);\n        pEl = pEl.firstElementChild;\n\n        while (pEl) {\n            walkDom(pEl, pCallback);\n            pEl = pEl.nextElementSibling;\n        }\n        \n    }\n}","export function cyborgEval(\n  pExpression: any,\n  pDataContext: any,\n  pAdditionalHelperVariables?: Record<string, any>\n): void {\n  const additionalHelperVariables: any = pAdditionalHelperVariables || {};\n  if (typeof pExpression === 'function') {\n    return pExpression.call(pDataContext);\n  }\n\n  return new Function(\n    ...Object.keys(additionalHelperVariables),\n    `var __cyborg_result; with($data) { __cyborg_result = ${pExpression} }; return __cyborg_result`\n  )(pDataContext, ...Object.values(additionalHelperVariables));\n}","import { MotherBoard } from './MotherBoard';\nimport { EventObject } from '../events/EventObject';\nimport { walkDom } from '../functions/walkDom';\nimport { cyborgEval } from '../functions/cyborgEval';\nimport { NotificationBody } from '../notifications/NotificationBody';\nimport { IAmComponent } from '../interfaces/IAmComponent';\n\nexport class Component implements IAmComponent{\n  \n  private _el: HTMLElement | undefined;\n  private _name = '';\n  private _events: Array<EventObject>;\n  private _motherboard: MotherBoard;\n  private _addEventListener: Function;\n  private _removeEventListener: Function;\n\n  protected _notifications: ReadonlyArray<string> = [];\n\n  constructor() {\n    this._motherboard = MotherBoard.getInstance();\n    this._events = [];\n\n    this._addEventListener = (pTarget: HTMLElement,pEventName: string,pHandler: Function): Function => {\n      const handler: Function = pHandler.bind(this);\n      this._events.push({\n        target: pTarget,\n        name: pEventName,\n        handler: handler,\n      });\n      return handler;\n    };\n\n    this._removeEventListener = (pTarget: HTMLElement,pEventName: string,\n      pHandler: Function\n    ): HTMLElement => {\n      const index: number = this._events.findIndex(\n        (evtObj: EventObject) => {\n          return (\n            evtObj.name === pEventName &&\n            evtObj.handler === pHandler\n          );\n        }\n      );\n      this._events.splice(index, 1);\n      return pTarget;\n    };\n  }\n\n  /**\n  * Bind your component in the system.\n  * @param {HTMLElement} pEl Connected Node\n  */\n  bind(pEl: HTMLElement): void {\n    this._el = pEl;\n    this._name = pEl.dataset.component || '';\n    this.registerInlineListeners();\n  }\n\n  onload(): void {\n    // window.onload trigger for component.\n  }\n\n  onunload(): void {\n    // window.onunload trigger for component.\n  }\n\n  addListener(pType: string): void {\n    this.motherboard.notifier.addNotificationListener(\n      this,\n      pType,\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      this.handleNotifications\n    );\n  }\n\n  removeListener(pType: string): void {\n    this.motherboard.notifier.removeNotificationListener(\n      pType,\n      this\n    );\n  }\n\n  notify(pType: string, pParams: Record<string, any> = {}): void {\n    this.motherboard.notifier.notify(pType, pParams);\n  }\n\n  handleNotifications(pObject: NotificationBody): void {\n    pObject.notification;\n  }\n\n  registerInlineListeners(): void {\n    if (this._el) {\n      walkDom(this._el, (element: HTMLElement) => {\n        if (element.dataset.component) {\n          return;\n        }\n        Array.from(element.attributes).forEach(\n          (pAttribute: Attr) => {\n            if (!pAttribute.name.startsWith('on')) return;\n            const event: string = pAttribute.name.replace('data-on:','');\n            \n            element.dataset[pAttribute.name] = pAttribute.value;\n            element.removeAttribute(pAttribute.name);\n            \n            const isFunction: boolean = pAttribute.value.includes('(') && pAttribute.value.includes(')');\n\n            if (isFunction) {\n              const handler: Function = this._addEventListener(element, event, new Function(`this.${pAttribute.value}`).bind(this));\n              element.addEventListener(event, handler as EventListener);\n            } else {\n              const handler: Function = this._addEventListener(element, event, () => {\n                  cyborgEval(\n                    this._motherboard.data,\n                    pAttribute.value\n                  );\n                }\n              );\n              element.addEventListener(event,handler as EventListener);\n            }\n          }\n        );\n      });\n    }\n  }\n\n  addEventListener(pEventName: string,pHandler: EventListenerOrEventListenerObject): void {\n    if (this._el) {\n      const handler: Function = this._addEventListener(\n        this._el,\n        pEventName,\n        pHandler\n      );\n      this._el.addEventListener(\n        pEventName,\n        handler as EventListenerOrEventListenerObject,\n        false\n      );\n    }\n}\n\n  removeEventListener(pEventName: string,pHandler: EventListenerOrEventListenerObject): void {\n    if (this._el) {\n      this._removeEventListener(this._el, pEventName, pHandler);\n      this._el.removeEventListener(pEventName, pHandler);\n    }\n  }\n\n  /**\n  * @param {Object} pData Data object to use\n  * @param {function} pTemplate template function\n  */\n  render(\n    pData: Record<string, any>,\n    pTemplate?: Function\n  ): void {\n    if (this._el) {\n      if (this._el.children) {\n        while (this._el.children.length > 0) {\n          this._el.children[0].remove();\n        }\n      }\n\n      if (pTemplate) {\n        this._el.innerHTML = pTemplate(pData);\n      } else {\n        this._el.innerHTML = this.getTemplate(pData);\n      }\n      this.motherboard.build(this._el);\n    }\n  }\n\n  /**\n  * @param {Object} pData\n  * @returns {string}\n  */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  getTemplate(pData?: Record<string, any>): string {\n    pData = pData || {};\n    return '';\n  }\n\n  get notifications(): ReadonlyArray<string>  {\n    return this._notifications; \n  }\n\n  get name(): string {\n    return this._name;\n  }\n\n  get el(): HTMLElement | undefined {\n    return this._el;\n  }\n\n  get motherboard(): MotherBoard {\n    return this._motherboard;\n  }\n\n  get events(): ReadonlyArray<Record<string, any>> {\n    return this._events;\n  }\n\n  /**\n  * Garbage collection ;)\n  */\n  destroy(): void {\n    this.motherboard.notifier.removeAllListenersFor(this);\n    while (this._events.length > 0) {\n      const event: EventObject = this._events[0];\n      this._removeEventListener(\n        event.target,\n        event.name,\n        event.handler\n      );\n      event.target.removeEventListener(\n        event.name,\n        event.handler as EventListenerOrEventListenerObject\n      );\n    }\n    if (this._el) {\n      this._el.remove();\n      this._el = undefined;\n    }\n  }\n}","import { MotherBoard } from './core/MotherBoard';\nimport { Component } from './core/Component';\nimport { Notification } from './notifications/Notification';\nimport { NotificationBody } from './notifications/NotificationBody';\n\nconst CyborgJS : any = { MotherBoard, Component, Notification, NotificationBody };\nexport default CyborgJS;\n"],"names":[],"mappings":";;;;;;EAAA,IAAY,UAGX;EAHD,WAAY,UAAU;MACpB,iDAAkC,CAAA;MAClC,yDAA0C,CAAA;EAC5C,CAAC,EAHW,UAAU,KAAV,UAAU;;ECEtB;MAKI,sBAAY,OAAgC,EAAE,KAAa,EAAE,QAAkB;UAC3E,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;UAClB,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC;UACxB,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC;OACzB;MACL,mBAAC;EAAD,CAAC;;ECZD;MAII,0BAAY,KAAa,EAAE,QAA8B;UACrD,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;UAC1B,IAAI,CAAC,OAAO,GAAG,QAAQ,IAAI,EAAE,CAAC;OACjC;MACL,uBAAC;EAAD,CAAC;;ECHD;MAKI;UACI,IAAI,sBAAsB,CAAC,SAAS,EAAE;cAClC,MAAM,IAAI,KAAK,CAAC,0CAA0C,CAAC,CAAC;WAC/D;UACD,sBAAsB,CAAC,SAAS,GAAG,IAAI,CAAC;UACxC,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;OACxB;MAEM,kCAAW,GAAlB;UACI,IAAI,sBAAsB,CAAC,SAAS,EAAE;cAClC,OAAO,sBAAsB,CAAC,SAAS,CAAC;WAC3C;UACD,OAAO,IAAI,sBAAsB,EAAE,CAAC;OACvC;;;;;;MAOD,uCAAM,GAAN,UAAO,KAAa,EAAE,OAA6B;UAC/C,IAAM,SAAS,GAAgC,IAAI,CAAC,UAAU,CAAC;UAC/D,IAAM,KAAK,GAAgC,SAAS,CAAC,MAAM,CAAC,UAAC,QAAsB;cAC/E,OAAO,QAAQ,CAAC,IAAI,KAAK,KAAK,CAAC;WAClC,CAAC,CAAC;UAEH,KAAK,CAAC,OAAO,CAAC,UAAC,IAAkB;cAC7B,IAAM,IAAI,GAAqB,IAAI,gBAAgB,CAAC,KAAK,EAAE,OAAO,IAAI,EAAE,CAAC,CAAC;cAC1E,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;WACtB,CAAC,CAAC;OACN;;;;;;;MAQD,wDAAuB,GAAvB,UAAwB,OAAgC,EAAE,KAAa,EAAE,QAAkB;UACvF,IAAM,IAAI,GAAiB,IAAI,YAAY,CAAC,OAAO,EAAE,KAAK,EAAE,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;UACpF,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;OAC9B;;;;;;MAOD,2DAA0B,GAA1B,UAA2B,KAAa,EAAE,OAAY;UAClD,IAAM,SAAS,GAAwB,IAAI,CAAC,UAAU,CAAC;UACvD,IAAM,KAAK,GAAW,SAAS,CAAC,SAAS,CAAC,UAAC,YAA0B;cACjE,OAAO,CAAC,YAAY,CAAC,IAAI,KAAK,KAAK,MAAM,YAAY,CAAC,MAAM,KAAK,OAAO,CAAC,CAAC;WAC7E,CAAC,CAAC;UACH,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;OAChD;MAED,sDAAqB,GAArB,UAAsB,SAAuB;UACzC,IAAM,SAAS,GAAwB,IAAI,CAAC,UAAU,CAAC;UACvD,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC,MAAM,CAAC,UAAC,YAA0B;cAC1D,QAAQ,YAAY,CAAC,MAAM,CAAC,IAAI,KAAK,SAAS,CAAC,IAAI,EAAE;WACxD,CAAC,CAAC;OACN;MAED,sBAAI,6CAAS;eAAb;cACI,OAAO,IAAI,CAAC,UAAU,CAAC;WAC1B;;;SAAA;MACL,6BAAC;EAAD,CAAC;;EC/DD;MAOE;UAJO,kBAAa,GAAwB,EAAE,CAAC;UACvC,gBAAW,GAAwB,EAAE,CAAC;UACtC,UAAK,GAAwB,EAAE,CAAC;UAGtC,IAAI,WAAW,CAAC,SAAS,EAAE;cACzB,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;WAClD;UACD,WAAW,CAAC,SAAS,GAAG,IAAI,CAAC;UAC7B,IAAI,CAAC,IAAI,EAAE,CAAC;OACb;MAEM,uBAAW,GAAlB;UACE,IAAI,WAAW,CAAC,SAAS,EAAE;cACzB,OAAO,WAAW,CAAC,SAAS,CAAC;WAC9B;UACD,OAAO,IAAI,WAAW,EAAE,CAAC;OAC1B;;;;MAKD,0BAAI,GAAJ;UAAA,iBAoBC;UAnBC,MAAM,CAAC,MAAM,GAAG;cACd,KAAI,CAAC,MAAM,EAAE,CAAC;WACf,CAAC;UAEF,MAAM,CAAC,QAAQ,GAAG;cAChB,KAAI,CAAC,QAAQ,EAAE,CAAC;WACjB,CAAC;UAEF,MAAM,CAAC,UAAU,GAAG;cAClB,KAAI,CAAC,OAAO,EAAE,CAAC;WAChB,CAAC;UAEF,QAAQ,CAAC,gBAAgB,CACvB,UAAU,CAAC,cAAc,EACzB;cACE,KAAI,CAAC,IAAI,EAAE,CAAC;WACb,EACD,KAAK,CACN,CAAC;OACH;;;;MAKD,0BAAI,GAAJ;UACE,IAAM,IAAI,GAA2B,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;UACpE,IAAI,CAAC,IAAI,EAAE;cACT,MAAM,KAAK,CAAC,uBAAuB,CAAC,CAAC;WACtC;UAED,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;UAC/B,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;UACzB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;OAClB;MAED,2BAAK,GAAL,UAAM,GAAgB;UAAtB,iBAsCC;UArCC,IAAM,cAAc,GAAuB,KAAK,CAAC,IAAI,CACnD,GAAG,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,CACzC,CAAC;UACF,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;cAC7B,cAAc,CAAC,OAAO,CAAC,UAAC,EAAe;kBACrC,IAAM,OAAO,GAAiB,EAAE,CAAC,OAAO,CAAC;kBACzC,IAAI,OAAO,IAAI,OAAO,CAAC,SAAS,EAAE;sBAChC,IAAM,eAAe,GAAkB,OAAO,CAAC,SAAS;2BACrD,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC;2BAChB,KAAK,CAAC,GAAG,CAAC,CAAC;sBACd,eAAe,CAAC,OAAO,CAAC,UAAC,eAAuB;0BAC9C,IAAM,cAAc,GAAwB,WAAW,CAAC,qBAAqB,CAC3E,KAAI,CAAC,aAAa,EAClB,eAAe,CAChB,CAAC;0BACF,IAAI,cAAc,EAAE;8BAClB,IAAM,SAAS,GAAiB,IAAI,cAAc,CAAC,KAAK,EAAE,CAAC;8BAC3D,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;8BACpC,IACE,SAAS,CAAC,aAAa;kCACvB,SAAS,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,EAClC;kCACA,KAAI,CAAC,oBAAoB,CAAC;sCACxB,IAAI,EAAE,eAAe;sCACrB,aAAa,EAAE,SAAS,CAAC,aAAa;sCACtC,QAAQ,EAAE,SAAS;mCACpB,CAAC,CAAC;+BACJ;8BAED,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;8BACnB,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;8BACjC,KAAI,CAAC,wBAAwB,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;2BAC9C;uBACF,CAAC,CAAC;mBACJ;eACF,CAAC,CAAC;WACJ;OACF;;;;MAKD,4BAAM,GAAN;UACE,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAC,UAAwB;cAChD,UAAU,CAAC,MAAM,EAAE,CAAC;WACrB,CAAC,CAAC;OACJ;MAED,8BAAQ,GAAR;UACE,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAC,UAAwB;cAChD,UAAU,CAAC,QAAQ,EAAE,CAAC;WACvB,CAAC,CAAC;OACJ;MAED,8CAAwB,GAAxB,UAAyB,UAAwB,EAAE,GAAgB;UACjE,IAAI,SAAS,GAAwB,UAAU,CAAC;UAChD,IAAI,EAAE,GAAuB,GAAG,CAAC;UACjC,IAAI,EAAE,EAAE;cACN,IAAI,MAAM,CAAC,gBAAgB,EAAE;kBAC3B,IAAI,UAAQ,GAA4B,IAAI,gBAAgB,CAC1D,UAAC,SAAgC;sBAC/B,SAAS,CAAC,OAAO,CAAC,UAAC,QAAwB;0BACzC,QAAQ,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,WAAiB;8BAC9C,IAAI,SAAS,IAAI,WAAW,KAAK,GAAG,EAAE;kCACpC,SAAS,CAAC,OAAO,EAAE,CAAC;kCACpB,IAAI,UAAQ,EAAE;sCACZ,UAAQ,CAAC,UAAU,EAAE,CAAC;sCACtB,UAAQ,GAAG,IAAI,CAAC;mCACjB;kCACD,SAAS,GAAG,IAAI,CAAC;kCACjB,EAAE,GAAG,IAAI,CAAC;+BACX;2BACF,CAAC,CAAC;uBACJ,CAAC,CAAC;mBACJ,CACF,CAAC;kBACF,UAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE;sBACzB,SAAS,EAAE,IAAI;sBACf,OAAO,EAAE,IAAI;mBACd,CAAC,CAAC;eACJ;mBAAM;kBACL,UAAU,CAAC,gBAAgB,CAAC,UAAU,CAAC,YAAY,EAAE;sBACnD,UAAU,CAAC,OAAO,EAAE,CAAC;sBACrB,SAAS,GAAG,IAAI,CAAC;sBACjB,EAAE,GAAG,IAAI,CAAC;mBACX,CAAC,CAAC;eACJ;WACF;OACF;MAED,0CAAoB,GAApB,UAAqB,OAAiC;UAAtD,iBAcC;UAbC,IAAI,OAAO,CAAC,aAAa,EAAE;cACzB,IAAM,aAAa,GAA0B,OAAO,CAAC,aAAa,CAAC;cACnE,IAAM,UAAQ,GAA4B,OAAO,CAAC,QAAQ,CAAC;cAC3D,aAAa,CAAC,OAAO,CAAC,UAAC,aAAqB;kBAE1C,KAAI,CAAC,QAAQ,CAAC,uBAAuB,CACnC,UAAQ,EACR,aAAa;;kBAEb,UAAQ,CAAC,mBAAmB,CAC7B,CAAC;eACH,CAAC,CAAC;WACJ;OACF;MAMD,sBAAI,iCAAQ;;;;;eAAZ;cACE,OAAO,sBAAsB,CAAC,WAAW,EAAE,CAAC;WAC7C;;;SAAA;MAED,sBAAI,6BAAI;eAAR;cACE,OAAO,IAAI,CAAC,KAAK,CAAC;WACnB;;;SAAA;MAED,sBAAI,mCAAU;eAAd;cACE,OAAO,IAAI,CAAC,WAAW,CAAC;WACzB;;;SAAA;;;MAIM,iCAAqB,GAA5B,UACE,MAA2B,EAC3B,KAAa;UAEb,IAAI,MAAM,KAAK,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE;cACjC,IAAI,SAAS,GAAwB,MAAM,CAAC,IAAI,CAAC,UAAC,IAAiB,IAAK,OAAA,IAAI,CAAC,SAAS,KAAK,KAAK,GAAA,CAAC,IAAI,IAAI,CAAC;cAC1G,OAAO,SAAS,CAAC;WAClB;UACD,OAAO,IAAI,CAAC;OACb;;;;MAKD,6BAAO,GAAP;UACE,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;cAClC,IAAM,SAAS,GAAiB,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;cACpD,IAAI,SAAS,IAAI,SAAS,CAAC,EAAE,EAAE;kBAC7B,SAAS,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC;eACvB;cACD,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;WAC1B;OACF;MACH,kBAAC;EAAD,CAAC;;WC9Ne,OAAO,CAAC,GAAmB,EAAE,SAAmB;MAC5D,IAAI,GAAG,EAAE;UACL,SAAS,CAAC,GAAG,CAAC,CAAC;UACf,GAAG,GAAG,GAAG,CAAC,iBAAiB,CAAC;UAE5B,OAAO,GAAG,EAAE;cACR,OAAO,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;cACxB,GAAG,GAAG,GAAG,CAAC,kBAAkB,CAAC;WAChC;OAEJ;EACL;;;;;;;;;;;;;;;;;;;;;;;;;WCXgB,UAAU,CACxB,WAAgB,EAChB,YAAiB,EACjB,0BAAgD;MAEhD,IAAM,yBAAyB,GAAQ,0BAA0B,IAAI,EAAE,CAAC;MACxE,IAAI,OAAO,WAAW,KAAK,UAAU,EAAE;UACrC,OAAO,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;OACvC;MAED,YAAW,QAAQ,YAAR,QAAQ,2BACd,MAAM,CAAC,IAAI,CAAC,yBAAyB,CAAC,GACzC,0DAAwD,WAAW,+BAA4B,qCAC/F,YAAY,GAAK,MAAM,CAAC,MAAM,CAAC,yBAAyB,CAAC,GAAE;EAC/D;;ECPA;MAWE;UAAA,iBA4BC;UApCO,UAAK,GAAG,EAAE,CAAC;UAMT,mBAAc,GAA0B,EAAE,CAAC;UAGnD,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC,WAAW,EAAE,CAAC;UAC9C,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;UAElB,IAAI,CAAC,iBAAiB,GAAG,UAAC,OAAoB,EAAC,UAAkB,EAAC,QAAkB;cAClF,IAAM,OAAO,GAAa,QAAQ,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;cAC9C,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC;kBAChB,MAAM,EAAE,OAAO;kBACf,IAAI,EAAE,UAAU;kBAChB,OAAO,EAAE,OAAO;eACjB,CAAC,CAAC;cACH,OAAO,OAAO,CAAC;WAChB,CAAC;UAEF,IAAI,CAAC,oBAAoB,GAAG,UAAC,OAAoB,EAAC,UAAkB,EAClE,QAAkB;cAElB,IAAM,KAAK,GAAW,KAAI,CAAC,OAAO,CAAC,SAAS,CAC1C,UAAC,MAAmB;kBAClB,QACE,MAAM,CAAC,IAAI,KAAK,UAAU;sBAC1B,MAAM,CAAC,OAAO,KAAK,QAAQ,EAC3B;eACH,CACF,CAAC;cACF,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;cAC9B,OAAO,OAAO,CAAC;WAChB,CAAC;OACH;;;;;MAMD,wBAAI,GAAJ,UAAK,GAAgB;UACnB,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;UACf,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC;UACzC,IAAI,CAAC,uBAAuB,EAAE,CAAC;OAChC;MAED,0BAAM,GAAN;;OAEC;MAED,4BAAQ,GAAR;;OAEC;MAED,+BAAW,GAAX,UAAY,KAAa;UACvB,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,uBAAuB,CAC/C,IAAI,EACJ,KAAK;;UAEL,IAAI,CAAC,mBAAmB,CACzB,CAAC;OACH;MAED,kCAAc,GAAd,UAAe,KAAa;UAC1B,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,0BAA0B,CAClD,KAAK,EACL,IAAI,CACL,CAAC;OACH;MAED,0BAAM,GAAN,UAAO,KAAa,EAAE,OAAiC;UAAjC,wBAAA,EAAA,YAAiC;UACrD,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;OAClD;MAED,uCAAmB,GAAnB,UAAoB,OAAyB;UAC3C,OAAO,CAAC,YAAY,CAAC;OACtB;MAED,2CAAuB,GAAvB;UAAA,iBAiCC;UAhCC,IAAI,IAAI,CAAC,GAAG,EAAE;cACZ,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE,UAAC,OAAoB;kBACrC,IAAI,OAAO,CAAC,OAAO,CAAC,SAAS,EAAE;sBAC7B,OAAO;mBACR;kBACD,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,OAAO,CACpC,UAAC,UAAgB;sBACf,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;0BAAE,OAAO;sBAC9C,IAAM,KAAK,GAAW,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,EAAC,EAAE,CAAC,CAAC;sBAE7D,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC,KAAK,CAAC;sBACpD,OAAO,CAAC,eAAe,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;sBAEzC,IAAM,UAAU,GAAY,UAAU,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,UAAU,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;sBAE7F,IAAI,UAAU,EAAE;0BACd,IAAM,OAAO,GAAa,KAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,KAAK,EAAE,IAAI,QAAQ,CAAC,UAAQ,UAAU,CAAC,KAAO,CAAC,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC,CAAC;0BACtH,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,OAAwB,CAAC,CAAC;uBAC3D;2BAAM;0BACL,IAAM,OAAO,GAAa,KAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,KAAK,EAAE;8BAC7D,UAAU,CACR,KAAI,CAAC,YAAY,CAAC,IAAI,EACtB,UAAU,CAAC,KAAK,CACjB,CAAC;2BACH,CACF,CAAC;0BACF,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAC,OAAwB,CAAC,CAAC;uBAC1D;mBACF,CACF,CAAC;eACH,CAAC,CAAC;WACJ;OACF;MAED,oCAAgB,GAAhB,UAAiB,UAAkB,EAAC,QAA4C;UAC9E,IAAI,IAAI,CAAC,GAAG,EAAE;cACZ,IAAM,OAAO,GAAa,IAAI,CAAC,iBAAiB,CAC9C,IAAI,CAAC,GAAG,EACR,UAAU,EACV,QAAQ,CACT,CAAC;cACF,IAAI,CAAC,GAAG,CAAC,gBAAgB,CACvB,UAAU,EACV,OAA6C,EAC7C,KAAK,CACN,CAAC;WACH;OACJ;MAEC,uCAAmB,GAAnB,UAAoB,UAAkB,EAAC,QAA4C;UACjF,IAAI,IAAI,CAAC,GAAG,EAAE;cACZ,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,GAAG,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAC;cAC1D,IAAI,CAAC,GAAG,CAAC,mBAAmB,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;WACpD;OACF;;;;;MAMD,0BAAM,GAAN,UACE,KAA0B,EAC1B,SAAoB;UAEpB,IAAI,IAAI,CAAC,GAAG,EAAE;cACZ,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE;kBACrB,OAAO,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;sBACnC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC;mBAC/B;eACF;cAED,IAAI,SAAS,EAAE;kBACb,IAAI,CAAC,GAAG,CAAC,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;eACvC;mBAAM;kBACL,IAAI,CAAC,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;eAC9C;cACD,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;WAClC;OACF;;;;;;MAOD,+BAAW,GAAX,UAAY,KAA2B;UAErC,OAAO,EAAE,CAAC;OACX;MAED,sBAAI,oCAAa;eAAjB;cACE,OAAO,IAAI,CAAC,cAAc,CAAC;WAC5B;;;SAAA;MAED,sBAAI,2BAAI;eAAR;cACE,OAAO,IAAI,CAAC,KAAK,CAAC;WACnB;;;SAAA;MAED,sBAAI,yBAAE;eAAN;cACE,OAAO,IAAI,CAAC,GAAG,CAAC;WACjB;;;SAAA;MAED,sBAAI,kCAAW;eAAf;cACE,OAAO,IAAI,CAAC,YAAY,CAAC;WAC1B;;;SAAA;MAED,sBAAI,6BAAM;eAAV;cACE,OAAO,IAAI,CAAC,OAAO,CAAC;WACrB;;;SAAA;;;;MAKD,2BAAO,GAAP;UACE,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;UACtD,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;cAC9B,IAAM,OAAK,GAAgB,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;cAC3C,IAAI,CAAC,oBAAoB,CACvB,OAAK,CAAC,MAAM,EACZ,OAAK,CAAC,IAAI,EACV,OAAK,CAAC,OAAO,CACd,CAAC;cACF,OAAK,CAAC,MAAM,CAAC,mBAAmB,CAC9B,OAAK,CAAC,IAAI,EACV,OAAK,CAAC,OAA6C,CACpD,CAAC;WACH;UACD,IAAI,IAAI,CAAC,GAAG,EAAE;cACZ,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC;cAClB,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC;WACtB;OACF;MACH,gBAAC;EAAD,CAAC;;MC1NK,QAAQ,GAAS,EAAE,WAAW,aAAA,EAAE,SAAS,WAAA,EAAE,YAAY,cAAA,EAAE,gBAAgB,kBAAA;;;;;;;;"}